# ๐ง ูุฏููู ุทูุจุงุช ุงูุตูุงูุฉ - ุฌุงูุฒ ููุฅูุชุงุฌ

## ูุธุฑุฉ ุนุงูุฉ
ูุฏููู ูุชูุงูู ูุฅุฏุงุฑุฉ ุทูุจุงุช ุงูุตูุงูุฉ ูุน ูุธุงู ุฅุดุนุงุฑุงุช ุชููุงุฆู ูุชุตููู ุฎุฏูุงุช ูุชุนุฏุฏ ุงููุณุชููุงุช.

---

## ๐ ุงูููููุงุช ุงูุฃุณุงุณูุฉ

### 1. ููุงุฐุฌ ุฅูุดุงุก ุงูุทูุจุงุช
- `ServiceCategoriesStep.tsx` - ุงุฎุชูุงุฑ ุงูุชุตููู ุงูุฑุฆูุณู
- `ServiceSelectionStep.tsx` - ุงุฎุชูุงุฑ ุงูุฎุฏูุงุช ุงููุฑุนูุฉ
- `RequestDetailsStep.tsx` - ุชูุงุตูู ุงูุทูุจ ูุงููุณุคูู

### 2. ุฅุฏุงุฑุฉ ุงูุทูุจุงุช
- `MaintenanceRequestsList.tsx` - ุนุฑุถ ูููุชุฑุฉ ุงูุทูุจุงุช
- `MaintenanceRequestActions.tsx` - ุฅุฌุฑุงุกุงุช ุนูู ุงูุทูุจุงุช
- `useMaintenanceRequests.ts` - Hook ูุฅุฏุงุฑุฉ ุงูุจูุงูุงุช

### 3. ูุธุงู ุงูุฅุดุนุงุฑุงุช
- Edge Function: `send-maintenance-notification`
  - ุฅุดุนุงุฑุงุช ุนูุฏ ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ
  - ุฅุดุนุงุฑุงุช ุนูุฏ ุชุบููุฑ ุงูุญุงูุฉ
  - ุฅุดุนุงุฑุงุช ุนูุฏ ุชุบููุฑ ุงููุฑุญูุฉ
  - ุฅุดุนุงุฑุงุช ุนูุฏ ุฅุชูุงู ุงูุทูุจ

---

## ๐๏ธ ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู maintenance_requests
```sql
- id (uuid)
- company_id (uuid) - ูุทููุจ
- branch_id (uuid) - ูุทููุจ
- created_by (uuid)
- title (text) - ูุทููุจ
- description (text)
- client_name (text) - ุงุณู ุงููุณุคูู
- client_phone (text)
- client_email (text)
- location (text) - ูุทููุจ
- service_type (text)
- category_id (uuid) - ุงูุชุตููู ุงูุฑุฆูุณู
- subcategory_id (uuid) - ุงูุฎุฏูุฉ ุงููุฑุนูุฉ
- status (enum: Open, InProgress, Completed, Closed)
- workflow_stage (text)
- estimated_cost (numeric)
- actual_cost (numeric)
- priority (text)
- rating (integer)
- created_at, updated_at
```

### ุฌุฏูู categories (ุงูุฎุฏูุงุช ุงูุฑุฆูุณูุฉ)
```sql
- id (uuid)
- name (text) - ูุทููุจ
- description (text)
- icon_url (text)
- sort_order (integer)
- is_active (boolean)
```

**ุงูุจูุงูุงุช ุงููุถุงูุฉ:**
- โก ููุฑุจุงุก (5 ุฎุฏูุงุช ูุฑุนูุฉ)
- ๐ฐ ุณุจุงูุฉ (5 ุฎุฏูุงุช ูุฑุนูุฉ)
- ๐ช ูุฌุงุฑุฉ (5 ุฎุฏูุงุช ูุฑุนูุฉ)
- ๐จ ุฏูุงูุงุช (5 ุฎุฏูุงุช ูุฑุนูุฉ)
- โ๏ธ ุชูููู ูุชุจุฑูุฏ (5 ุฎุฏูุงุช ูุฑุนูุฉ)

### ุฌุฏูู services (ุงูุฎุฏูุงุช ุงููุฑุนูุฉ)
```sql
- id (uuid)
- name (text) - ูุทููุจ
- description (text)
- category_id (uuid) - FK ุฅูู categories
- base_price (numeric) - ูุทููุจ
- unit (text) - ูุทููุจ
- is_active (boolean)
- requires_inspection (boolean)
- inspection_price (numeric)
- estimated_duration (integer) - ุจุงูุฏูุงุฆู
- sort_order (integer)
```

**ุฃูุซูุฉ ุนูู ุงูุฎุฏูุงุช:**
1. ุฅุตูุงุญ ูุดุงูุงุช ุงูุฅูุงุฑุฉ - 150 ุฌููู
2. ุชุณููู ูุฌุงุฑู - 200 ุฌููู
3. ุชุฑููุจ ุฃุฑูู ุฎุดุจูุฉ - 150 ุฌููู
4. ุฏูุงู ุบุฑูุฉ - 60 ุฌููู/ูยฒ
5. ุตูุงูุฉ ุฏูุฑูุฉ ููููู - 250 ุฌููู

### ุฌุฏูู notifications
```sql
- id (uuid)
- recipient_id (uuid) - FK ุฅูู auth.users
- sender_id (uuid)
- title (text) - ูุทููุจ
- message (text) - ูุทููุจ
- type (text) - info, success, warning, error
- entity_type (text) - maintenance_request
- entity_id (uuid)
- read_at (timestamp)
- created_at, updated_at
```

---

## ๐ ุณูุงุณุงุช ุงูุฃูุงู (RLS)

### maintenance_requests
โ **SELECT**: ูููู ูููุณุชุฎุฏู ุฑุคูุฉ ุทูุจุงุช ุดุฑูุชู
โ **INSERT**: ูููู ุฅูุดุงุก ุทูุจุงุช ูููุณุชุฎุฏููู ุงููุตุฑุญ ููู
โ **UPDATE**: ูููู ููููุธููู ูุงูููุดุฆ ุชุญุฏูุซ ุงูุทูุจุงุช
โ **DELETE**: ููุท ุงูููุธููู (staff)

### categories & services
โ **SELECT**: ูุฑุงุกุฉ ุนุงูุฉ ููุฌููุน
โ **INSERT/UPDATE/DELETE**: ููุท ุงูููุธููู

### notifications
โ **SELECT**: ูููู ูููุณุชุฎุฏู ุฑุคูุฉ ุฅุดุนุงุฑุงุชู ููุท
โ **UPDATE**: ูููู ูููุณุชุฎุฏู ุชุญุฏูุซ ุญุงูุฉ ูุฑุงุกุฉ ุฅุดุนุงุฑุงุชู
โ **INSERT**: ููุท ุงูููุธููู ูุงููุธุงู

---

## โ ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช

### Client-Side Validation (Zod)
```typescript
- title: ูุทููุจุ ุญุฏ ุฃุฏูู ุญุฑู ูุงุญุฏ
- client_name: ูุทููุจ (ุงุณู ุงููุณุคูู)
- location: ูุทููุจ
- client_email: ุชูุณูู ุจุฑูุฏ ุตุญูุญ (ุงุฎุชูุงุฑู)
- category_id: ุงุฎุชูุงุฑู
- subcategory_id: ุงุฎุชูุงุฑู
```

### Server-Side Validation
- ุงูุชุญูู ูู ูุฌูุฏ company_id ู branch_id
- ุงูุชุญูู ูู created_by ูุจู ุงูุฅุฏุฑุงุฌ
- ุงูุชุญูู ูู ุตูุงุญูุงุช ุงูุชุนุฏูู ูุงูุญุฐู

---

## ๐ ูุธุงู ุงูุฅุดุนุงุฑุงุช

### ุฃุญุฏุงุซ ุงูุฅุดุนุงุฑุงุช
1. **request_created** - ุนูุฏ ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ
   - ุฅุดุนุงุฑ ููููุดุฆ
   - ุฅุดุนุงุฑ ููููุธููู ูุงููุฏุฑุงุก

2. **status_changed** - ุนูุฏ ุชุบููุฑ ุงูุญุงูุฉ
   - ูู: Open โ InProgress โ Completed โ Closed
   - ุฅุดุนุงุฑ ููููุดุฆ ูุงูููุธููู

3. **stage_changed** - ุนูุฏ ุชุบููุฑ ูุฑุญูุฉ ุงูุนูู
   - draft โ submitted โ assigned โ in_progress โ completed
   - ุฅุดุนุงุฑ ููููุดุฆ ูุงูููุธููู

4. **request_completed** - ุนูุฏ ุฅุชูุงู ุงูุทูุจ
   - ุฅุดุนุงุฑ ุฎุงุต ุจุงูุฅุชูุงู

### Edge Function
```typescript
// ุงุณุชุฏุนุงุก ุงูุฅุดุนุงุฑ
await supabase.functions.invoke('send-maintenance-notification', {
  body: {
    request_id: 'uuid',
    event_type: 'request_created',
    old_status?: 'Open',
    new_status?: 'InProgress'
  }
});
```

---

## ๐ฑ ุงูุชุตููู ุงููุชุฌุงูุจ

### ุฏุนู ุงูุฃุฌูุฒุฉ
โ ุงูููุงุชู ุงููุญูููุฉ (320px+)
โ ุงูุฃุฌูุฒุฉ ุงูููุญูุฉ (768px+)
โ ุฃุฌูุฒุฉ ุณุทุญ ุงูููุชุจ (1024px+)

### ููุงุท ุงูุชูุณูุฑ (Breakpoints)
- Mobile: ุนููุฏ ูุงุญุฏ ููููุงุฐุฌ
- Tablet: ุนููุฏูู ููุญููู
- Desktop: ุซูุงุซุฉ ุฃุนูุฏุฉ ููุจุทุงูุงุช

---

## ๐จ ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

### ุณูุฑ ุนูู ุฅูุดุงุก ุงูุทูุจ
1. ุงุฎุชูุงุฑ ุงูุชุตููู ุงูุฑุฆูุณู (ููุฑุจุงุกุ ุณุจุงูุฉุ ุฅูุฎ)
2. ุงุฎุชูุงุฑ ุงูุฎุฏูุงุช ุงููุฑุนูุฉ (ูุชุนุฏุฏ)
3. ููุก ุชูุงุตูู ุงูุทูุจ
   - ุงูุนูุงุฑ (ุงุฎุชูุงุฑู)
   - ุนููุงู ุงูุทูุจ
   - ููุน ุงูุฎุฏูุฉ ูุงูุฎุฏูุฉ ุงููุฑุนูุฉ
   - ุงุณู ุงููุณุคูู
   - ุจูุงูุงุช ุงูุงุชุตุงู
   - ุงููููุน
   - ุงูุชุงุฑูุฎ ูุงูููุช ุงูููุถู
4. ูุฑุงุฌุนุฉ ูุฅุฑุณุงู

### ุงููููุฒุงุช
โ ุญุณุงุจ ุงูุชูููุฉ ุงูุชูุฏูุฑูุฉ ุชููุงุฆูุงู
โ ุฏุนู ุงูุฎุฏูุงุช ุงูุชู ุชุชุทูุจ ูุนุงููุฉ
โ ุนุฑุถ ุงูุฃุณุนุงุฑ ุจูุถูุญ
โ ุฑุณุงุฆู ูุฌุงุญ/ุฎุทุฃ ูุงุถุญุฉ
โ ุชุญุฏูุซุงุช ููุฑูุฉ (Realtime)

---

## ๐งช ุงูุงุฎุชุจุงุฑุงุช ุงููุทููุจุฉ

### ุงุฎุชุจุงุฑุงุช ูุธูููุฉ
- โ ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ ูุน ุฌููุน ุงูุจูุงูุงุช ุงููุทููุจุฉ
- โ ุฅูุดุงุก ุทูุจ ุจุฏูู ุนูุงุฑ (ุงุฎุชูุงุฑู)
- โ ุงุฎุชูุงุฑ ุชุตููู ูุฎุฏูุฉ ูุฑุนูุฉ
- โ ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ
- โ ุชุญุฏูุซ ูุฑุญูุฉ ุงูุทูุจ
- โ ุญุฐู ุทูุจ (ููููุธููู ููุท)
- โ ุงุณุชูุงู ุฅุดุนุงุฑุงุช ุนูุฏ ุงูุชุบููุฑุงุช

### ุงุฎุชุจุงุฑุงุช ุงูุฃูุงู
- โ ูุง ูููู ุฑุคูุฉ ุทูุจุงุช ุดุฑูุงุช ุฃุฎุฑู
- โ ูุง ูููู ุงูุชุนุฏูู ุจุฏูู ุตูุงุญูุงุช
- โ ูุง ูููู ุงูุญุฐู ูููุณุชุฎุฏููู ุงูุนุงุฏููู
- โ ุงูุชุญูู ูู created_by ุนูุฏ ุงูุฅูุดุงุก

### ุงุฎุชุจุงุฑุงุช ุงูุฃุฏุงุก
- โ๏ธ ุชุญููู ุงูููุงุฆู ุจุณุฑุนุฉ
- โ๏ธ Realtime updates ุจุฏูู ุชุฃุฎูุฑ
- โ๏ธ Edge function ุงุณุชุฌุงุจุฉ ุณุฑูุนุฉ

---

## ๐ ุงููุดุงูู ุงููุนุฑููุฉ ูุงูุญููู

### โ ุชู ุงูุฅุตูุงุญ
1. **ุงููููุฐุฌ ูุง ูุฑุณู ุงูุจูุงูุงุช** โ
   - ุงูุณุจุจ: ุนุฏู ูุฌูุฏ `created_by`
   - ุงูุญู: ุฅุถุงูุฉ `created_by: user.id` ุนูุฏ ุงูุฅูุดุงุก

2. **ุงุณู ุงูุญูู ุบูุฑ ูุงุถุญ** โ
   - ุงูุณุจุจ: "ุงุณู ุงูุนููู" ูุฑุจู
   - ุงูุญู: ุชุบููุฑ ุฅูู "ุงุณู ุงููุณุคูู"

3. **ุนุฏู ูุฌูุฏ ุญูู ููุฎุฏูุฉ ุงููุฑุนูุฉ** โ
   - ุงูุญู: ุฅุถุงูุฉ `category_id` ู `subcategory_id`

4. **ุนุฏู ูุฌูุฏ ุฅุดุนุงุฑุงุช** โ
   - ุงูุญู: ุฅูุดุงุก edge function ููุฅุดุนุงุฑุงุช

### โ๏ธ ููุงุท ุงูุชุญุณูู ุงููุณุชูุจููุฉ
- ุฅุถุงูุฉ ุฑูุน ุงูุตูุฑ ููุทูุจุงุช
- ุฅุถุงูุฉ ูุธุงู ุชูููู ููุฎุฏูุฉ
- ุฅุถุงูุฉ ุชูุงุฑูุฑ ุชุญููููุฉ
- ุฅุถุงูุฉ ุชุตุฏูุฑ ุงูุจูุงูุงุช

---

## ๐ ูุชุทูุจุงุช ุงููุดุฑ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ ุฌููุน ุงูุฌุฏุงูู ููุฌูุฏุฉ
โ RLS ูููุนูู ุนูู ุฌููุน ุงูุฌุฏุงูู
โ ุงูุณูุงุณุงุช ูููููุฉ ุจุดูู ุตุญูุญ
โ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ (categories & services) ููุฌูุฏุฉ

### Edge Functions
โ `send-maintenance-notification` ููุดูุฑุฉ
โ CORS ูููุนูู
โ JWT Authentication ูููุนูู

### ุงูุจูุฆุฉ
- โ SUPABASE_URL
- โ SUPABASE_ANON_KEY
- โ SUPABASE_SERVICE_ROLE_KEY (ููู edge function)

---

## ๐ ุงููุซุงุฆู ูุงููุฑุงุฌุน

### ุฑูุงุจุท Supabase
- Dashboard: https://supabase.com/dashboard/project/zrrffsjbfkphridqyais
- Edge Functions: https://supabase.com/dashboard/project/zrrffsjbfkphridqyais/functions
- Database: https://supabase.com/dashboard/project/zrrffsjbfkphridqyais/editor

### ุงูููุฏ ุงููุฑุฌุนู
- `/src/hooks/useMaintenanceRequests.ts` - ุฅุฏุงุฑุฉ ุงูุทูุจุงุช
- `/src/components/service-request/` - ููุงุฐุฌ ุงูุทูุจุงุช
- `/supabase/functions/send-maintenance-notification/` - ุงูุฅุดุนุงุฑุงุช

---

## โ ุญุงูุฉ ุงูุฌุงูุฒูุฉ

| ุงููููู | ุงูุญุงูุฉ |
|--------|---------|
| ูุงุฌูุฉ ุงููุณุชุฎุฏู | โ ุฌุงูุฒ |
| ูุงุนุฏุฉ ุงูุจูุงูุงุช | โ ุฌุงูุฒ |
| ุงูุฃูุงู (RLS) | โ ุฌุงูุฒ |
| ุงูุชุญูู ูู ุงูุจูุงูุงุช | โ ุฌุงูุฒ |
| ูุธุงู ุงูุฅุดุนุงุฑุงุช | โ ุฌุงูุฒ |
| ุงูุชุตููู ุงููุชุฌุงูุจ | โ ุฌุงูุฒ |
| ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ | โ ุฌุงูุฒ |
| ุงููุซุงุฆู | โ ุฌุงูุฒ |

**ุงููุฏููู ุฌุงูุฒ ูููุดุฑ ุนูู ุงูุฅูุชุงุฌ** ๐

---

## ๐ ุขุฎุฑ ุชุญุฏูุซ
ุงูุชุงุฑูุฎ: 2025-11-10
ุงููุณุฎุฉ: 2.0
ุงููุญุฏุซ ุจูุงุณุทุฉ: AI Assistant
