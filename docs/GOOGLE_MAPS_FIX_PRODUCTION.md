# ๐บ๏ธ ุฏููู ุฅุตูุงุญ Google Maps API ููุฅูุชุงุฌ - UberFix.shop

## ๐ด ุงููุดููุฉ ุงูุญุงููุฉ

```
Google Maps JavaScript API error: RefererNotAllowedMapError
Your site URL to be authorized: https://c6adaf51-0eef-43e8-bf45-d65ac7ebe1aa.lovableproject.com/service-map
```

**ุงูุณุจุจ:** ูุทุงู ุงููุดุฑูุน ุบูุฑ ูุตุฑุญ ุจู ูู ุฅุนุฏุงุฏุงุช Google Cloud Console.

---

## โ ุงูุญู ุงููุงูู ุฎุทูุฉ ุจุฎุทูุฉ

### ๐ **ุงูุฎุทูุฉ 1: ุงููุตูู ุฅูู Google Cloud Console**

1. ุงูุชุญ ุงููุชุตูุญ ูุงุฐูุจ ุฅูู:
   ```
   https://console.cloud.google.com/google/maps-apis/credentials
   ```

2. ุณุฌูู ุงูุฏุฎูู ุจุญุณุงุจ Google ุงูุฐู ุฃูุดุฃุช ุจู ููุชุงุญ Maps API

3. **ุงุฎุชุฑ ุงููุดุฑูุน ุงูุตุญูุญ** ูู ุงููุงุฆูุฉ ุงูุนูููุฉ ุฅุฐุง ูุงู ูุฏูู ุฃูุซุฑ ูู ูุดุฑูุน

---

### ๐ **ุงูุฎุทูุฉ 2: ุชุญุฏูุฏ ุงูููุชุงุญ ุงูุญุงูู**

1. ุณุชุฌุฏ ูุงุฆูุฉ ุจุฌููุน API Keys ูู ุงูุตูุญุฉ

2. ุงุจุญุซ ุนู ุงูููุชุงุญ ุงูุฐู ูุจุฏุฃ ุจู:
   ```
   AIzaSyDrSEYA_2HoB3IQuIg6OThed9r53I8gRGk
   ```
   (ูุฐุง ูู ุงูููุชุงุญ ุงููุณุชุฎุฏู ูู ูุดุฑูุนู)

3. ุงุถุบุท ุนูู **ุงุณู ุงูููุชุงุญ** ุฃู ุฃููููุฉ ุงูููู (โ๏ธ) ุจุฌุงูุจู

---

### ๐ **ุงูุฎุทูุฉ 3: ุชุนุฏูู ูููุฏ HTTP Referrers**

#### 3.1 ุงูุนุซูุฑ ุนูู ูุณู Application restrictions

ูู ุตูุญุฉ ุชุนุฏูู ุงูููุชุงุญุ ุงุจุญุซ ุนู ูุณู **"Application restrictions"**

#### 3.2 ุงุฎุชูุงุฑ HTTP referrers

- โ ุงุฎุชุฑ: **"HTTP referrers (web sites)"**
- โ ูุง ุชุฎุชุฑ: "IP addresses" ุฃู "None"

#### 3.3 ุฅุถุงูุฉ ุงููุทุงูุงุช ุงููุทููุจุฉ

ูู ุญูู **"Website restrictions"**ุ ุฃุถู ุงููุทุงูุงุช ุงูุชุงููุฉ **ูุงุญุฏูุง ุชูู ุงูุขุฎุฑ**:

```
https://c6adaf51-0eef-43e8-bf45-d65ac7ebe1aa.lovableproject.com/*
https://*.lovableproject.com/*
http://localhost:*
http://127.0.0.1:*
```

**ุฅุฐุง ูุงู ูุฏูู ูุทุงู ุฅูุชุงุฌ ุฎุงุต (ูุซู www.uberfix.shop)ุ ุฃุถู ุฃูุถูุง:**

```
https://www.uberfix.shop/*
https://uberfix.shop/*
https://*.uberfix.shop/*
```

---

### ๐ **ุงูุฎุทูุฉ 4: ุชูุนูู Google Maps APIs ุงููุทููุจุฉ**

ุชุฃูุฏ ูู ุชูุนูู ุงูู APIs ุงูุชุงููุฉ ููุดุฑูุนู:

1. ุงุฐูุจ ุฅูู:
   ```
   https://console.cloud.google.com/apis/library
   ```

2. ุงุจุญุซ ููุนูู ุงูู APIs ุงูุชุงููุฉ (ุฅุฐุง ูู ุชูู ููุนููุฉ):

   #### โ APIs ุงููุทููุจุฉ:
   - **Maps JavaScript API** (ุฃุณุงุณู)
   - **Places API** (ููุจุญุซ ุนู ุงูุฃูุงูู)
   - **Geocoding API** (ูุชุญููู ุงูุนูุงููู ุฅูู ุฅุญุฏุงุซูุงุช)
   - **Geolocation API** (ุงุฎุชูุงุฑู - ูุชุญุฏูุฏ ูููุน ุงููุณุชุฎุฏู)

3. ูุชูุนูู API:
   - ุงุถุบุท ุนูู ุงุณู ุงูู API
   - ุงุถุบุท **"Enable"** ุฃู **"ุชูุนูู"**

---

### ๐ **ุงูุฎุทูุฉ 5: ุชูููุฏ API ุงุณุชุฎุฏุงู (API restrictions)**

ูู ููุณ ุตูุญุฉ ุชุนุฏูู ุงูููุชุงุญ:

1. ุงุฐูุจ ุฅูู ูุณู **"API restrictions"**

2. ุงุฎุชุฑ: **"Restrict key"**

3. ุญุฏุฏ ุงูู APIs ุงูุชู ูุณูุญ ููููุชุงุญ ุจุงุณุชุฎุฏุงููุง:
   - โ Maps JavaScript API
   - โ Places API
   - โ Geocoding API
   - โ Geolocation API (ุฅุฐุง ููุช ุชุณุชุฎุฏููุง)

4. ุงุถุบุท **"Save"** ุฃู **"ุญูุธ"**

---

### ๐ **ุงูุฎุทูุฉ 6: ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช ุงูููุงุฆูุฉ**

ูุฌุจ ุฃู ุชููู ุฅุนุฏุงุฏุงุชู ูุงูุชุงูู:

```yaml
Application restrictions:
  Type: HTTP referrers (web sites)
  
Website restrictions:
  - https://c6adaf51-0eef-43e8-bf45-d65ac7ebe1aa.lovableproject.com/*
  - https://*.lovableproject.com/*
  - http://localhost:*
  - http://127.0.0.1:*
  - https://www.uberfix.shop/* (ูุทุงูู ุฅุฐุง ูุงู ูุชุงุญูุง)
  - https://*.uberfix.shop/*

API restrictions:
  Type: Restrict key
  APIs: 
    - Maps JavaScript API
    - Places API
    - Geocoding API
    - Geolocation API
```

---

### ๐ **ุงูุฎุทูุฉ 7: ุงูุงูุชุธุงุฑ ูุงูุงุฎุชุจุงุฑ**

#### โฑ๏ธ ูุฏุฉ ุงูุชุทุจูู:

- **ุนุงุฏุฉู:** ุงูุชุบููุฑุงุช ุชุณุฑู ุฎูุงู **2-5 ุฏูุงุฆู**
- **ุฃุญูุงููุง:** ูุฏ ุชุณุชุบุฑู ุญุชู **10 ุฏูุงุฆู**

#### ๐งช ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ:

1. **ุงูุณุญ ุงูู cache:**
   - Chrome/Edge: ุงุถุบุท `Ctrl + Shift + Delete` โ ุงูุณุญ ุงูู cache
   - ุฃู ุงูุชุญ ูุงูุฐุฉ ุชุตูุญ ุฎุงุต (Incognito)

2. **ุงูุชุญ ุตูุญุฉ ุงูุฎุฑูุทุฉ:**
   ```
   https://c6adaf51-0eef-43e8-bf45-d65ac7ebe1aa.lovableproject.com/service-map
   ```

3. **ุงูุชุญ Console:**
   - ุงุถุบุท `F12`
   - ุงุฐูุจ ุฅูู ุชุจููุจ **Console**

4. **ุชุญูู ูู ุนุฏู ูุฌูุฏ ุงูุฎุทุฃ:**
   - โ ูุฌุจ **ุนุฏู** ุธููุฑ: `RefererNotAllowedMapError`
   - โ ูุฌุจ ุธููุฑ: `โ Google Maps API Key loaded from cache`
   - โ ูุฌุจ ุธููุฑ: ุงูุฎุฑูุทุฉ ุจุดูู ุตุญูุญ ูุน 131 ูููุน ูุฑุน + 10 ููููู

---

## ๐ง ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### โ ุงููุดููุฉ: ูุง ูุฒุงู ุงูุฎุทุฃ ููุฌูุฏูุง ุจุนุฏ 10 ุฏูุงุฆู

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุญูุธ ุงูุชุนุฏููุงุช ูู Google Cloud Console
2. ุชุญูู ูู ุฃูู ุชุนุฏู ุงูููุชุงุญ ุงูุตุญูุญ (`AIzaSyDrSEYA_2HoB3IQuIg6OThed9r53I8gRGk`)
3. ุงูุณุญ ุงูู cache ุจุงููุงูู ุฃู ุงุณุชุฎุฏู ูุถุน ุงูุชุตูุญ ุงูุฎุงุต
4. ุชุญูู ูู ุนุฏู ูุฌูุฏ ูุณุงูุงุช ุฒุงุฆุฏุฉ ูู ุงููุทุงูุงุช ุงููุฏุฎูุฉ

---

### โ ุงููุดููุฉ: ุงูุฎุฑูุทุฉ ุชุธูุฑ ููู ุจุฏูู ุฃููููุงุช

**ุงูุญู:**
1. ุงูุชุญ Console (`F12`)
2. ุงุจุญุซ ุนู ุฃุฎุทุงุก ุชุญููู ุงูุฃููููุงุช
3. ุชุญูู ูู ุฃู ูุณุงุฑ `/icons/pin-pro/pin-pro-24.svg` ููุฌูุฏ
4. ุชุญูู ูู ุฃู ุฌุฏูู `branch_locations` ูุญุชูู ุนูู 131 ุณุฌู

**ููุชุญูู ูู ุงูุจูุงูุงุช:**
```sql
SELECT COUNT(*) FROM branch_locations WHERE latitude IS NOT NULL AND longitude IS NOT NULL;
-- ูุฌุจ ุฃู ูุฑุฌุน: 131
```

---

### โ ุงููุดููุฉ: ุฎุทุฃ "This API project is not authorized to use this API"

**ุงูุญู:**
1. ุงุฐูุจ ุฅูู: https://console.cloud.google.com/apis/library
2. ุงุจุญุซ ุนู "Maps JavaScript API"
3. ุชุฃูุฏ ูู ุฃููุง **ููุนููุฉ (Enabled)**
4. ูุฑุฑ ูู Places API ู Geocoding API

---

### โ ุงููุดููุฉ: ุฎุทุฃ "The provided API key is invalid"

**ุงูุญู:**
1. ุชุญูู ูู ุฃู ุงูููุชุงุญ ุงููุญููุธ ูู Supabase Secrets ุตุญูุญ
2. ุงูุชุญ Supabase Dashboard:
   ```
   https://supabase.com/dashboard/project/zrrffsjbfkphridqyais/settings/vault/secrets
   ```
3. ุชุญูู ูู ูููุฉ `GOOGLE_MAPS_API_KEY`
4. ุฅุฐุง ูุงู ุฎุงุทุฆูุงุ ุญุฏูุซู ุจุงูููุชุงุญ ุงูุตุญูุญ

---

## ๐ ูุฑุงูุจุฉ ุงูุงุณุชุฎุฏุงู ูุงูุญุตุฉ

### ููููุฉ ูุฑุงูุจุฉ ุงุณุชููุงู API:

1. ุงูุชุญ:
   ```
   https://console.cloud.google.com/apis/api/maps-backend.googleapis.com/quotas
   ```

2. ุณุชุฌุฏ:
   - **ุนุฏุฏ ุงูุทูุจุงุช ุงูููููุฉ**
   - **ุนุฏุฏ ุงูุทูุจุงุช ุงูุญุงููุฉ**
   - **ุงูุญุตุฉ ุงููุชุจููุฉ**

### ุงูุญุตุฉ ุงููุฌุงููุฉ:

- **$200 ุดูุฑููุง ูุฌุงููุง** ูู Google
- ูุฐุง ูุนุงุฏู ุชูุฑูุจูุง:
  - **28,000** ุชุญููู ุฎุฑูุทุฉ ุดูุฑููุง
  - **40,000** ุงุณุชุนูุงู Geocoding
  - **17,000** ุงุณุชุนูุงู Places API

### ุชูุนูู ุชูุจููุงุช ุงูุญุตุฉ:

1. ุงุฐูุจ ุฅูู:
   ```
   https://console.cloud.google.com/billing/budgets
   ```

2. ุงุถุบุท **"Create Budget"**

3. ุงุถุจุท ุญุฏ ุชูุจูู ุนูุฏ **$150** (75% ูู ุงูุญุตุฉ ุงููุฌุงููุฉ)

---

## ๐ฏ ุงูุชุญุณููุงุช ุงูููุตู ุจูุง ุจุนุฏ ุงูุฅุตูุงุญ

### 1. ุชูุนูู Lazy Loading ููุฎุฑุงุฆุท

ูู `src/lib/googleMapsLoader.ts`ุ ุงููุดุฑูุน ูุณุชุฎุฏู ุจุงููุนู `async: true` ู `defer: true` - ููุชุงุฒ! โ

### 2. ุชูุนูู Map Clustering

ุงููุดุฑูุน ูุณุชุฎุฏู `@googlemaps/markerclusterer` ุจุงููุนู - ููุชุงุฒ! โ

### 3. Caching ููุชุงุญ API

ุงููุดุฑูุน ููุฎุฒู ุงูููุชุงุญ ูู `localStorage` ููุฏุฉ ุณุงุนุฉ - ููุชุงุฒ! โ

---

## ๐ ุงูุฏุนู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ ุจุนุฏ ุงุชุจุงุน ุฌููุน ุงูุฎุทูุงุช:

1. **ุชุญูู ูู ุงูู Console Logs:**
   ```javascript
   // ุงูุชุญ F12 > Console
   // ุงุจุญุซ ุนู ุฑุณุงุฆู ุชุจุฏุฃ ุจู:
   "Google Maps JavaScript API error:"
   ```

2. **ุชุญูู ูู Network Requests:**
   ```
   F12 > Network > ุงุจุญุซ ุนู ุทูุจ ุฅูู:
   https://maps.googleapis.com/maps/api/js
   ```

3. **ุฑุงุฌุน ูุซุงุฆู Google:**
   - [Error Messages Guide](https://developers.google.com/maps/documentation/javascript/error-messages)
   - [API Key Best Practices](https://developers.google.com/maps/api-security-best-practices)

---

## โ Checklist ุงูููุงุฆู

ูุจู ุงูุฅูุชุงุฌุ ุชุฃูุฏ ูู:

- [ ] ุชู ุชูุนูู ุฌููุน ุงูู APIs ุงููุทููุจุฉ
- [ ] ุชู ุฅุถุงูุฉ ุฌููุน ุงููุทุงูุงุช (Development + Production)
- [ ] ุชู ุชูููุฏ ุงูููุชุงุญ ุจุงูู APIs ุงููุทููุจุฉ ููุท
- [ ] ุชู ุงุฎุชุจุงุฑ ุงูุฎุฑูุทุฉ ูู ูุถุน ุงูุชุตูุญ ุงูุฎุงุต
- [ ] ุชู ุธููุฑ 131 ูููุน ูุฑุน + 10 ููููู
- [ ] ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู Console
- [ ] ุชู ุชูุนูู ุชูุจููุงุช ุงูุญุตุฉ
- [ ] ุชู ุชูุซูู ุงูููุชุงุญ ุจุดูู ุขูู ูู Supabase Secrets

---

**ุขุฎุฑ ุชุญุฏูุซ:** 11 ููููุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุชุทุจูู ุงูููุฑู
